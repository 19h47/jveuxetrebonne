{#

partials/carousel-recipe

@author  Jérémy Levron <jeremylevron@19h47.fr

#}

{% for collection in post.get_field( 'collection' ) %}
	<div id="carousel-recipe-{{ random( 1, 100 ) }}" class="Carousel-recipe page-block d-none d-md-block" data-node-type="CarouselRecipe" itemscope itemtype="http://schema.org/Recipe">
		<meta itemprop="author" content="{{ post.author }}">
		<meta itemprop="name" content="{{ post.title }}">
		<meta itemprop="datePublished" content="{{ post.post_date }}">
		<meta itemprop="recipeCuisine" content="{{ post.cuisine | default( 'France' ) }}">

		{% if post.thumbnail %}
			<meta itemprop="image" content="{{ Image( post.thumbnail ).src }}">
		{% endif %}

		{% if post.description %}
			<meta itemprop="description" content="{{ post.description }}">
		{% endif %}

		<meta itemprop="recipeCategory" content="{{ post.terms( 'recipe_category' ) | map( term => term.name ) | join( ', ' ) }}">

		<div class="items js-container">

			<div class="item">
				<div class="item__inner">
					{% if collection.image | length %}
						<img src="{{ TimberImage( collection.image ).src( 'large' ) }}">
					{% endif %}
				</div>

				<div class="item__inner">

					<h3 class="Carousel-recipe__title">
						{{- collection.description | default( pll__( 'Pour commencer <br> tu as besoin de :' ) ) -}}
					</h3>

					{% if post.person_number or post.preparation_time or post.cooking_time %}
						<ul class="d-flex margin-y-5 align-items-center padding-0 justify-content-center" style="list-style-type: none;">
							{{ post.person_number ? "<li class=\"person-number\" itemprop=\"recipeYield\">#{ post.person_number } pers.</li>" }}
							{{ post.preparation_time ? "<li class=\"preparation-time\" itemprop=\"prepTime\" content=\" PT#{ post.preparation_time }M\">#{ post.preparation_time } min</li>" }}
							{{ post.cooking_time ? "<li class=\"cooking-time\" itemprop=\"cookTime\">#{ post.cooking_time } min</li>" }}
						</ul>
					{% endif %}

					{% if collection.ingredients %}
						<ul class="Carousel-recipe__ingredients">
							{{- collection.ingredients | map(item => "<li itemprop=\"recipeIngredient\">#{ item.ingredient }</li>") | join -}}
						</ul>
					{% endif %}
				</div>

			</div>

			{% for step in collection.steps %}
				<div class="item">
					<div class="item__inner">
						{% if step.image|length %}
							<img src="{{ TimberImage( step.image ).src }}">
						{% endif %}
					</div>
					<div class="item__inner">
						<p class="Carousel-recipe__title title-step">
							{{- pll__( 'Étape' ) -}}&nbsp;{{ loop.index }}
						</p>
						{{- step.description -}}
					</div>
				</div>
			{% endfor %}
		</div>

	    {% if collection.steps | length > 0 %}

		    <div class="Carousel-recipe__progressbar js-progressbar" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>

		    {% include 'partials/slider-navigation.html.twig' with { count: collection.steps | length + 1 } %}

		{% endif %}
	</div>

	<div id="carousel-recipe-{{ random( 1, 100 ) }}" class="Carousel-recipe page-block d-md-none" data-node-type="SliderRecipe">

		<div class="items js-container">

			<div class="item">
				<div class="item__inner image-mobile">
					{% if collection.image | length %}
						<img src="{{ TimberImage( collection.image ).src }}">
					{% endif %}
				</div>
			</div>
			<div class="item">
				<div class="item__inner ingredients-mobile">
					<h3 class="Carousel-recipe__title">
						{{- collection.description | default( pll__( 'Pour commencer <br> tu as besoin de :' ) ) -}}
					</h3>

					{% if post.person_number or post.preparation_time or post.cooking_time %}
						<ul class="d-flex align-items-center margin-y-5">
							{{- post.person_number ? "<li class=\"person-number\">#{ post.person_number } pers.</li>" : '' -}}
							{{- post.preparation_time ? "<li class=\"preparation-time\">#{ post.preparation_time } min</li>" : '' -}}
							{{- post.cooking_time ? "<li class=\"cooking-time\">#{ post.cooking_time } min</li>" : '' -}}
						</ul>
					{% endif %}

					{% if collection.ingredients %}
						<ul class="Carousel-recipe__ingredients">
							{{- collection.ingredients | map(item => "<li itemprop=\"recipeIngredient\">#{ item.ingredient }</li>" ) | join -}}
						</ul>
					{% endif %}

				</div>

			</div>

			{% for step in collection.steps %}
				<div class="item">
					<div class="item__inner image-mobile">
						{% if step.image | length %}
							<img src="{{ TimberImage( step.image ).src }}">
						{% endif %}
					</div>
				</div>
				<div class="item">
					<div class="item__inner ingredients-mobile">

						<p class="Carousel-recipe__title title-step">
							{{- pll__( 'Étape' ) -}}&nbsp;{{ loop.index }}
						</p>
						{{- step.description -}}
					</div>

				</div>
			{% endfor %}
		</div>

	    {% if collection.steps | length > 0 %}

		    <div class="Carousel-recipe__progressbar js-progressbar" role="progressbar" aria-valuemin="0" aria-valuemax="100"></div>
			{% include 'partials/slider-navigation.html.twig' with { count: collection.steps|length + 1 } %}

		{% endif %}
	</div>

{% endfor %}
